---
import { Programs } from "@repo/program-data";
import TableLayout from "../../components/layouts/table-layout.astro";
import { ProgramsDataTable } from "../../data/programs";

const p = Programs.instance;

export function getStaticPaths() {
  const programs = Programs.instance;

  const ages = programs.getAgeDisplay();
  return ages.map((a) => {
    return {
      params: { age: a.slug },
    };
  });
}

const { age: ageSlug } = Astro.params;

const age = p.getAgeDisplay().find((a) => a.slug === ageSlug);

const programs = p.filterByAge(ageSlug);
---

<TableLayout title={age?.label || ""}>
  <ProgramsDataTable client:load programs={programs.programs} />
</TableLayout>
